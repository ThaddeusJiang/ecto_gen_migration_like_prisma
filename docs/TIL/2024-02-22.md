# 2024-02-22

> ![Important]
> imo: ä½¿ç”¨ Prisma Migration ä»£æ›¿ Ecto Migration å¯¹æˆ‘æ¥è¯´å¾ˆæ£’ï¼Œå› ä¸ºæˆ‘ä¸å…³ç³»å¦‚ä½•ç¼–å†™ database migrationï¼Œåªéœ€è¦å…³å¿ƒå¦‚ä½•ä½¿ç”¨ database clientã€‚
> è™½ç„¶å¯èƒ½é€ æˆä¾èµ–å·¥å…·å¢å¤šï¼ŒğŸ˜‚
>
> ä¸¤ç§è§£å†³æ–¹å¼ï¼š
>
> 1. å­¦ä¹  Ecto Migrationï¼Œæ¯æ¬¡å¾ˆçƒ¦ã€‚
> 2. å¼€å‘ä¸€ä¸ªå·¥å…·ï¼Œå®ç°ç±»ä¼¼ Prisma Migration çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä½¿ç”¨ Ectoã€‚

1. Ecto.Schema è‡ªå¸¦ id å­—æ®µï¼Œå¹¶ä¸”é»˜è®¤ä¸ºæ•´å‹ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰ id å­—æ®µï¼Œéœ€è¦åœ¨ schema ä¸­ä½¿ç”¨ `@primary_key` æ³¨è§£æ¥æŒ‡å®šã€‚

```elixir
defmodule MyApp.User do
  use Ecto.Schema
  @primary_key {:uuid, :binary_id, autogenerate: true}
  schema "users" do
    field :name, :string
    field :email, :string
  end
end
```

- `:id`: integer
- `binary_id`: binary
- Ecto.UUID: uuid

Ecto å’Œå…¶ä»–è¯­è¨€ä¸ä¸€æ ·çš„åœ°æ–¹ï¼š binary vs. string

![ecto type, elixir type, examples](./2024-02-22/%20ecto%20type,%20elixir%20type,%20examples.png)

![Ecto.UUID](./2024-02-22/Ecto.UUID.png)

ref: [Ecto.Schema](https://hexdocs.pm/ecto/Ecto.Schema.html#module-primary-key)

2. Prisma é»˜è®¤ä¸ä½¿ç”¨ database native uuid ç±»å‹ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šã€‚

```prisma
model User {
  id String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
}
```

BTW: å¦‚æœæƒ³ä½¿ç”¨å…¶ä»– native database functionsï¼Œå¯ä»¥é€šè¿‡ `extensions` å¼€å¯ã€‚

https://www.prisma.io/docs/orm/prisma-schema/data-model/unsupported-database-features
